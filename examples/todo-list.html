<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two-Way Binding Demo - Template Engine</title>
</head>
<body>
    
    <div id="app"></div>

    <template id="app-template">
        <h1>üìù Project Tasks</h1>
        <p>Two-way data binding with inline editing</p>

        <ul>
            <each of="todos" as="todo">
                <li attr-item-id="todo.id">
                    <get>todo.name</get>

                    <if test="todo.showEdit">
                        <input type="text" bind-input-value="todo.name" placeholder="Edit task..." />
                    </if>

                    <button class="edit-button" action-click="edit">‚úèÔ∏è Edit</button>
                </li>
            </each>
        </ul>

        <label for="new-todo-input">New task:</label>
        <input id="new-todo-input" type="text" bind-input-value="newTodo" placeholder="What needs to be done?" />
        <button id="add-todo-btn" action-click="add">‚ûï Add Task</button>
    </template>

    <template-use id="app-template-use" template-id="app-template" mount-id="app"></template-use>

    <script type="module">

        import TemplateEngine from '../src/template-engine.js'

        const data = TemplateEngine.reactive({
            todos: [
                { id: 1, name: 'Review pull requests', showEdit: false },
                { id: 2, name: 'Update documentation', showEdit: false },
                { id: 3, name: 'Fix responsive layout', showEdit: false }
            ],
            newTodo: '',
            add: function() {
                if (data.newTodo.trim()) {
                    data.todos.push({ id: data.todos.length + 1, name: data.newTodo, showEdit: false })
                    data.newTodo = ''
                }
            },
            edit: function(e) {
                const todo = data.todos.find(t => t.id == e.target.parentElement.getAttribute('item-id'))
                if (todo) {
                    todo.showEdit = !todo.showEdit
                }
            }
        }, document.getElementById('app-template-use'))

        data.todos.push({ id: 4, name: 'Plan team meeting', showEdit: false })

    </script>

</body>
</html>