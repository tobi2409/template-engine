<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recursive Templates Demo - Template Engine</title>
</head>
<body>

    <div id="app"></div>

    <template id="folder-template">
        <each of="*list" as="item">
            <li>üìÅ <get>item.name</get> (<get>item.size</get> items)

                <ul>
                    <template-use template-id="folder-template" data-list="item.childs"></template-use>
                </ul>

            </li>
        </each>
    </template>

    <template id="app-template">
        <h1>üìÇ File System Browser</h1>
        <p>Current user: <strong><get>name</get></strong></p>
        <p>Browsing: <get>param1</get> drive</p>

        <h2>Directory Structure</h2>
        <ul>
            <template-use template-id="folder-template" data-list="folders"></template-use>
        </ul>
    </template>

    <template-use id="app-template-use" template-id="app-template" mount-id="app" data-param1="/home"></template-use>

    <script type="module">
        import TemplateEngine from '../src/template-engine.js'

        const data = TemplateEngine.reactive({
            name: 'Alex Johnson',
            folders: [{
                name: 'projects',
                size: 2,
                childs: [{
                    name: 'website',
                    size: 0,
                    childs: []
                }, {
                    name: 'mobile-app',
                    size: 0,
                    childs: []
                }]
            }, {
                name: 'documents',
                size: 1,
                childs: [{
                    name: 'reports',
                    size: 0,
                    childs: []
                }]
            }]
        }, document.getElementById('app-template-use'))

        // Demonstrate deep nesting and dynamic updates
        data.folders[0].name = 'projects (active)'
        data.folders[0].childs.push({ name: 'data-analysis', size: 0, childs: [] })
        data.folders[0].childs.push({ name: 'api-server', size: 1, childs: [ { name: 'controllers', size: 1, childs: [ { name: 'auth', size: 0, childs: [] } ] } ] })
        data.folders[0].childs.splice(1, 0, { name: 'tools', size: 0, childs: [] })
        data.folders.splice(1, 0, { name: 'downloads', size: 1, childs: [{ name: 'archives', size: 0, childs: [] }] })
        data.folders[1].name = 'downloads (recent)'
        data.folders[0].childs.splice(2, 1)
        data.folders.pop()
        data.folders[0].childs[1].name = 'scripts'
        data.folders[0].childs[2].name = 'data-science'

        console.log('File system data:', data)
    </script>

</body>

</html>