<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conditional Rendering Demo - Template Engine</title>
</head>
<body>

    <div id="app"></div>

    <template id="team-template">
        <each of="*list" as="member">
            <if test="member.active" wrapper="li">
                <get>member.name</get> - <get>member.role</get>

                <ul>
                    <template-use template-id="team-template" data-list="member.reports"></template-use>
                </ul>
            </if>
        </each>
    </template>

    <template id="app-template">
        <h1>ðŸ‘¤ User Dashboard</h1>
        <p>Welcome back, <strong><get>name</get></strong></p>
        <p>Environment: <get>param1</get></p>

        <if test="showSalary">
            <p>ðŸ’° Annual Salary: $<get>salary</get></p>
        </if>

        <h2>Active Team Members</h2>
        <ul>
            <template-use template-id="team-template" data-list="team"></template-use>
        </ul>
    </template>

    <template-use id="app-template-use" template-id="app-template" mount-id="app" data-param1="Production"></template-use>

    <script type="module">
        import TemplateEngine from '../src/template-engine.js'

        const data = TemplateEngine.reactive({
            name: 'Morgan Davis',
            salary: 85000,
            showSalary: true,
            team: [{
                name: 'Sophie Turner',
                role: 'Senior Engineer',
                active: true,
                reports: [{
                    name: 'Liam Chen',
                    role: 'Mid-level Engineer',
                    reports: [],
                    active: true
                }, {
                    name: 'Olivia Martinez',
                    role: 'Junior Engineer',
                    reports: [],
                    active: true
                }]
            }, {
                name: 'Noah Anderson',
                role: 'Designer',
                active: true,
                reports: [{
                    name: 'Emma Wilson',
                    role: 'UI Designer',
                    reports: [],
                    active: false
                }]
            }]
        }, document.getElementById('app-template-use'))

        // Demonstrate conditional rendering updates
        data.team[0].name = 'Sophie Turner (Team Lead)'
        data.team[0].reports.push({ active: true, name: 'Ava Johnson', role: 'Intern', reports: [] })
        data.team[0].reports.push({ active: true, name: 'Ethan Brown', role: 'Engineer', reports: [ { active: true, name: 'Isabella Garcia', role: 'Contractor', reports: [ { active: true, name: 'Mason Lee', role: 'Consultant', reports: [] } ] } ] })
        data.team[0].reports.splice(1, 0, { active: true, name: 'James Miller', role: 'DevOps', reports: [] })
        data.team.splice(1, 0, { active: true, name: 'Charlotte Davis', role: 'Product Manager', reports: [{ active: true, name: 'Benjamin Moore', role: 'Product Analyst', reports: [] }] })
        data.team[1].name = 'Charlotte Davis (New)'
        data.team[0].reports.splice(2, 1)
        data.team[0].reports[1].name = 'James Miller (Updated)'
        data.team[0].reports[2].name = 'Ava Johnson (Promoted)'
        data.showSalary = false
        data.showSalary = true
        data.team[0].reports[2].active = false

        console.log('Dashboard data:', data)
    </script>

</body>

</html>